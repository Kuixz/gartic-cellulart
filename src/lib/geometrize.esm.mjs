/** ----------------------------------------------------------------------
  *                              geometrize
  *       With credit to Sam Twidale (https://github.com/Tw1ddle)
  * ---------------------------------------------------------------------- */
var t={},i={};!function(t,i){function h(t,i){var h=Object.create(t);for(var r in i)h[r]=i[r];return i.toString!==Object.prototype.toString&&(h.toString=i.toString),h}t.geometrize=t.geometrize||{},t.geometrize.bitmap=t.geometrize.bitmap||{},t.geometrize.exporter=t.geometrize.exporter||{},t.geometrize.runner=t.geometrize.runner||{},t.geometrize.shape=t.geometrize.shape||{};var r=function(){};r.remove=function(t,i){var h=t.indexOf(i);return-1!=h&&(t.splice(h,1),!0)},r.now=function(){return Date.now()};var o=function(){};o.random=function(t){return t<=0?0:Math.floor(Math.random()*t)};var e=function(){};e.replace=function(t,i,h){return t.split(i).join(h)};var n={toFloat:function(t){return t<0?4294967296+t:t+0}},s={create:function(t){return null==t?[]:s.toSet(t)},intersection:function(t,i){for(var h=[],r=0;r<t.length;){var o=t[r];++r,s.contains(i,o)&&h.push(o)}return t=h},union:function(t,i){return s.toSet(t.concat(s.toArray(i)))},unionArray:function(t,i){return s.toSet(t.concat(i))},difference:function(t,i){for(var h=t.slice(),o=0,e=i;o<e.length;){var n=e[o];++o,r.remove(h,n)}return t=s.toArray(h)},add:function(t,i){if(null==i)throw W.thrown("FAIL: element != null");return!s.contains(t,i)&&(t.push(i),!0)},contains:function(t,i){for(var h=0;h<t.length;){var r=t[h];if(++h,r==i)return!0}return!1},copy:function(t){return t.slice()},slice:function(t,i,h){return t.slice(i,h)},splice:function(t,i,h){return t.splice(i,h)},toArray:function(t){return t.slice()},toSet:function(t){for(var i=[],h=0;h<t.length;){var r=t[h];++h,s.add(i,r)}return i},_new:function(t){return t}},a=function(){};a.computeColor=function(t,i,h,r){if(null==t)throw W.thrown("FAIL: target != null");if(null==i)throw W.thrown("FAIL: current != null");if(null==h)throw W.thrown("FAIL: lines != null");if(r<0)throw W.thrown("FAIL: alpha >= 0");for(var o=0,e=0,n=0,s=0,a=0|65535/r,f=0;f<h.length;){var l=h[f];++f;for(var u=l.y,w=l.x1,g=l.x2+1;w<g;){var d=w++,x=t.offsetY*t.originalWidth+t.offsetX+(t.originalWidth*u+d),y=t.data[x],c=i.offsetY*i.originalWidth+i.offsetX+(i.originalWidth*u+d),p=i.data[c];o+=((y>>24&255)-(p>>24&255))*a+257*(p>>24&255),e+=((y>>16&255)-(p>>16&255))*a+257*(p>>16&255),n+=((y>>8&255)-(p>>8&255))*a+257*(p>>8&255),++s}}if(0==s)return 0;var m,v=(m=(o/s|0)>>8)<0?0:m>255?255:m,F=(m=(e/s|0)>>8)<0?0:m>255?255:m,L=(m=(n/s|0)>>8)<0?0:m>255?255:m;return((v<0?0:v>255?255:v)<<24)+((F<0?0:F>255?255:F)<<16)+((L<0?0:L>255?255:L)<<8)+(r<0?0:r>255?255:r)},a.differenceFull=function(t,i){if(null==t)throw W.thrown("FAIL: first != null");if(null==i)throw W.thrown("FAIL: second != null");if(0==t.width)throw W.thrown("FAIL: first.width != 0");if(0==t.height)throw W.thrown("FAIL: first.height != 0");if(0==i.width)throw W.thrown("FAIL: second.width != 0");if(0==i.height)throw W.thrown("FAIL: second.height != 0");var h,r;if((h=t.width)!=(r=i.width))throw W.thrown("FAIL: values are not equal (expected: "+r+", actual: "+h+")");if((h=t.height)!=(r=i.height))throw W.thrown("FAIL: values are not equal (expected: "+r+", actual: "+h+")");for(var o=0,e=t.width,n=t.height,s=0,a=n;s<a;)for(var f=s++,l=0,u=e;l<u;){var w=l++,g=t.offsetY*t.originalWidth+t.offsetX+(t.originalWidth*f+w),d=t.data[g],x=i.offsetY*i.originalWidth+i.offsetX+(i.originalWidth*f+w),y=i.data[x],c=(d>>24&255)-(y>>24&255),p=(d>>16&255)-(y>>16&255),m=(d>>8&255)-(y>>8&255),v=(255&d)-(255&y);o+=c*c+p*p+m*m+v*v}var F=Math.sqrt(o/(e*n*4))/255;if(!isFinite(F))throw W.thrown("FAIL: Math.isFinite(result)");return F},a.differencePartial=function(t,i,h,r,o){if(null==t)throw W.thrown("FAIL: target != null");if(null==i)throw W.thrown("FAIL: before != null");if(null==h)throw W.thrown("FAIL: after != null");if(null==o)throw W.thrown("FAIL: lines != null");if(0==o.length)throw W.thrown("FAIL: lines.length != 0");for(var e=t.width*t.height*4,n=Math.pow(255*r,2)*e,s=0;s<o.length;){var a=o[s];++s;for(var f=a.y,l=a.x1,u=a.x2+1;l<u;){var w=l++,g=t.offsetY*t.originalWidth+t.offsetX+(t.originalWidth*f+w),d=t.data[g],x=i.offsetY*i.originalWidth+i.offsetX+(i.originalWidth*f+w),y=i.data[x],c=h.offsetY*h.originalWidth+h.offsetX+(h.originalWidth*f+w),p=h.data[c],m=(d>>24&255)-(y>>24&255),v=(d>>16&255)-(y>>16&255),F=(d>>8&255)-(y>>8&255),L=(255&d)-(255&y),A=(d>>24&255)-(p>>24&255),I=(d>>16&255)-(p>>16&255),M=(d>>8&255)-(p>>8&255),S=(255&d)-(255&p);n-=m*m+v*v+F*F+L*L,n+=A*A+I*I+M*M+S*S}}var B=Math.sqrt(n/e)/255;if(!isFinite(B))throw W.thrown("FAIL: Math.isFinite(result)");return B},a.bestRandomState=function(t,i,h,r,o,e,n){for(var s=0,a=null,f=0,u=h;f<u;){var w=f++,g=new l(M.randomShapeOf(t,o.width,o.height),i,r,o,e),d=g.energy(n);(0==w||d<s)&&(s=d,a=g)}return a},a.bestHillClimbState=function(t,i,h,r,o,e,n,s){var f=a.bestRandomState(t,i,h,o,e,n,s);return f=a.hillClimb(f,r,s)},a.hillClimb=function(t,i,h){if(null==t)throw W.thrown("FAIL: state != null");if(i<0)throw W.thrown("FAIL: maxAge >= 0");for(var r=t.clone(),o=r.clone(),e=r.energy(h),n=0;n<i;){var s=r.mutate(),a=r.energy(h);a>=e?r=s:(e=a,o=r.clone(),n=-1),++n}return o},a.energy=function(t,i,h,r,o,e){if(null==t)throw W.thrown("FAIL: shape != null");if(null==h)throw W.thrown("FAIL: target != null");if(null==r)throw W.thrown("FAIL: current != null");if(null==o)throw W.thrown("FAIL: buffer != null");var n=t.rasterize();if(null==n)throw W.thrown("FAIL: lines != null");if(0==n.length)throw W.thrown("FAIL: lines.length != 0");var s=a.computeColor(h,r,n,i);return x.copyLines(o,r,n),x.drawLines(o,s,n),a.differencePartial(h,r,o,e,n)};var f=function(t,i){if(null==t)throw W.thrown("FAIL: target != null");this.width=t.width,this.height=t.height,this.target=t,t.saveOffSet(!0);for(var h=t.width,r=t.height,o=w.createBitmapOfLength(h,r,h*r),e=0;e<o.data.length;)o.data[e]=i,++e;for(this.current=o,h=t.width,r=t.height,o=w.createBitmapOfLength(h,r,h*r),e=0;e<o.data.length;)o.data[e]=i,++e;this.buffer=o,t.restoreOffset();var n,s=this.current;if(null==(n=t.width!=t.originalWidth||t.height!=t.originalHeight||0!=t.offsetX||0!=t.offsetY?{x:t.offsetX,y:t.offsetY,width:t.width,height:t.height}:null))s.width=s.originalWidth,s.height=s.originalHeight,s.offsetX=0,s.offsetY=0;else{if(n.width<=0)throw W.thrown("FAIL: offset.width > 0");if(n.x+n.width>s.originalWidth)throw W.thrown("FAIL: offset.x + offset.width <= originalWidth");if(n.height<=0)throw W.thrown("FAIL: offset.height > 0");if(n.y+n.height>s.originalHeight)throw W.thrown("FAIL: offset.y + offset.height <= originalHeight");if(n.x<0)throw W.thrown("FAIL: offset.x >= 0");if(n.y<0)throw W.thrown("FAIL: offset.y >= 0");s.width=n.width,s.height=n.height,s.offsetX=n.x,s.offsetY=n.y}if(s=this.buffer,null==(n=t.width!=t.originalWidth||t.height!=t.originalHeight||0!=t.offsetX||0!=t.offsetY?{x:t.offsetX,y:t.offsetY,width:t.width,height:t.height}:null))s.width=s.originalWidth,s.height=s.originalHeight,s.offsetX=0,s.offsetY=0;else{if(n.width<=0)throw W.thrown("FAIL: offset.width > 0");if(n.x+n.width>s.originalWidth)throw W.thrown("FAIL: offset.x + offset.width <= originalWidth");if(n.height<=0)throw W.thrown("FAIL: offset.height > 0");if(n.y+n.height>s.originalHeight)throw W.thrown("FAIL: offset.y + offset.height <= originalHeight");if(n.x<0)throw W.thrown("FAIL: offset.x >= 0");if(n.y<0)throw W.thrown("FAIL: offset.y >= 0");s.width=n.width,s.height=n.height,s.offsetX=n.x,s.offsetY=n.y}this.score=a.differenceFull(t,this.current)};f.prototype={setOffset:function(t){var i=this.current;if(null==t)i.width=i.originalWidth,i.height=i.originalHeight,i.offsetX=0,i.offsetY=0;else{if(t.width<=0)throw W.thrown("FAIL: offset.width > 0");if(t.x+t.width>i.originalWidth)throw W.thrown("FAIL: offset.x + offset.width <= originalWidth");if(t.height<=0)throw W.thrown("FAIL: offset.height > 0");if(t.y+t.height>i.originalHeight)throw W.thrown("FAIL: offset.y + offset.height <= originalHeight");if(t.x<0)throw W.thrown("FAIL: offset.x >= 0");if(t.y<0)throw W.thrown("FAIL: offset.y >= 0");i.width=t.width,i.height=t.height,i.offsetX=t.x,i.offsetY=t.y}if(i=this.current,null==t)i.width=i.originalWidth,i.height=i.originalHeight,i.offsetX=0,i.offsetY=0;else{if(t.width<=0)throw W.thrown("FAIL: offset.width > 0");if(t.x+t.width>i.originalWidth)throw W.thrown("FAIL: offset.x + offset.width <= originalWidth");if(t.height<=0)throw W.thrown("FAIL: offset.height > 0");if(t.y+t.height>i.originalHeight)throw W.thrown("FAIL: offset.y + offset.height <= originalHeight");if(t.x<0)throw W.thrown("FAIL: offset.x >= 0");if(t.y<0)throw W.thrown("FAIL: offset.y >= 0");i.width=t.width,i.height=t.height,i.offsetX=t.x,i.offsetY=t.y}if(i=this.target,null==t)i.width=i.originalWidth,i.height=i.originalHeight,i.offsetX=0,i.offsetY=0;else{if(t.width<=0)throw W.thrown("FAIL: offset.width > 0");if(t.x+t.width>i.originalWidth)throw W.thrown("FAIL: offset.x + offset.width <= originalWidth");if(t.height<=0)throw W.thrown("FAIL: offset.height > 0");if(t.y+t.height>i.originalHeight)throw W.thrown("FAIL: offset.y + offset.height <= originalHeight");if(t.x<0)throw W.thrown("FAIL: offset.x >= 0");if(t.y<0)throw W.thrown("FAIL: offset.y >= 0");i.width=t.width,i.height=t.height,i.offsetX=t.x,i.offsetY=t.y}this.width=this.target.width,this.height=this.target.height,this.score=a.differenceFull(this.target,this.current)},step:function(t,i,h,r){var o=a.bestHillClimbState(t,i,h,r,this.target,this.current,this.buffer,this.score);return[this.addShape(o.shape,o.alpha)]},addShape:function(t,i){if(null==t)throw W.thrown("FAIL: shape != null");var h=this.current,r=w.createBitmapOfLength(h.originalWidth,h.originalHeight,h.data.length),o=h.width!=h.originalWidth||h.height!=h.originalHeight||0!=h.offsetX||0!=h.offsetY?{x:h.offsetX,y:h.offsetY,width:h.width,height:h.height}:null;if(null==o)r.width=r.originalWidth,r.height=r.originalHeight,r.offsetX=0,r.offsetY=0;else{if(o.width<=0)throw W.thrown("FAIL: offset.width > 0");if(o.x+o.width>r.originalWidth)throw W.thrown("FAIL: offset.x + offset.width <= originalWidth");if(o.height<=0)throw W.thrown("FAIL: offset.height > 0");if(o.y+o.height>r.originalHeight)throw W.thrown("FAIL: offset.y + offset.height <= originalHeight");if(o.x<0)throw W.thrown("FAIL: offset.x >= 0");if(o.y<0)throw W.thrown("FAIL: offset.y >= 0");r.width=o.width,r.height=o.height,r.offsetX=o.x,r.offsetY=o.y}for(var e=0,n=h.data.length;e<n;){var s=e++;r.data[s]=h.data[s]}var f=r,l=t.rasterize(),u=a.computeColor(this.target,this.current,l,i);x.drawLines(this.current,u,l),this.score=a.differencePartial(this.target,f,this.current,this.score,l);var g=(h=this.current).width!=h.originalWidth||h.height!=h.originalHeight||0!=h.offsetX||0!=h.offsetY?{x:h.offsetX,y:h.offsetY,width:h.width,height:h.height}:null;return null!=g&&t.translate(g),{score:this.score,color:u,shape:t}}};var l=function(t,i,h,r,o){if(null==t)throw W.thrown("FAIL: shape != null");this.shape=t,this.alpha=i,this.score=-1,this.target=h,this.current=r,this.buffer=o};l.prototype={energy:function(t){return this.score<0&&(this.score=a.energy(this.shape,this.alpha,this.target,this.current,this.buffer,t)),this.score},mutate:function(){var t=this.clone();return this.shape.mutate(),t},clone:function(){return new l(this.shape.clone(),this.alpha,this.target,this.current,this.buffer)}};var u=function(){};u.prototype={setOffset:function(t){if(null==t)this.width=this.originalWidth,this.height=this.originalHeight,this.offsetX=0,this.offsetY=0;else{if(t.width<=0)throw W.thrown("FAIL: offset.width > 0");if(t.x+t.width>this.originalWidth)throw W.thrown("FAIL: offset.x + offset.width <= originalWidth");if(t.height<=0)throw W.thrown("FAIL: offset.height > 0");if(t.y+t.height>this.originalHeight)throw W.thrown("FAIL: offset.y + offset.height <= originalHeight");if(t.x<0)throw W.thrown("FAIL: offset.x >= 0");if(t.y<0)throw W.thrown("FAIL: offset.y >= 0");this.width=t.width,this.height=t.height,this.offsetX=t.x,this.offsetY=t.y}},getOffSet:function(){return this.width!=this.originalWidth||this.height!=this.originalHeight||0!=this.offsetX||0!=this.offsetY?{x:this.offsetX,y:this.offsetY,width:this.width,height:this.height}:null},saveOffSet:function(t){this.savedOffset=this.width!=this.originalWidth||this.height!=this.originalHeight||0!=this.offsetX||0!=this.offsetY?{x:this.offsetX,y:this.offsetY,width:this.width,height:this.height}:null,t&&(this.width=this.originalWidth,this.height=this.originalHeight,this.offsetX=0,this.offsetY=0)},restoreOffset:function(){if(null!=this.savedOffset){var t=this.savedOffset;if(null==t)this.width=this.originalWidth,this.height=this.originalHeight,this.offsetX=0,this.offsetY=0;else{if(t.width<=0)throw W.thrown("FAIL: offset.width > 0");if(t.x+t.width>this.originalWidth)throw W.thrown("FAIL: offset.x + offset.width <= originalWidth");if(t.height<=0)throw W.thrown("FAIL: offset.height > 0");if(t.y+t.height>this.originalHeight)throw W.thrown("FAIL: offset.y + offset.height <= originalHeight");if(t.x<0)throw W.thrown("FAIL: offset.x >= 0");if(t.y<0)throw W.thrown("FAIL: offset.y >= 0");this.width=t.width,this.height=t.height,this.offsetX=t.x,this.offsetY=t.y}}},getCoordsIndex:function(t,i){return this.offsetY*this.originalWidth+this.offsetX+(this.originalWidth*i+t)}};var w=t.geometrize.bitmap.Bitmap=function(){};w.createBitmapOfLength=function(t,i,h){var r=new w;r.width=t,r.height=i,r.originalWidth=t,r.originalHeight=i,r.offsetX=0,r.offsetY=0;var o=new Array(h);return r.data=o,r},w.create=function(t,i,h){for(var r=w.createBitmapOfLength(t,i,t*i),o=0;o<r.data.length;)r.data[o]=h,++o;return r},w.createFromBytes=function(t,i,h){if(null==h)throw W.thrown("FAIL: bytes != null");var r=h.length,o=t*i*4;if(r!=o)throw W.thrown("FAIL: values are not equal (expected: "+o+", actual: "+r+")");for(var e=w.createBitmapOfLength(t,i,h.length/4|0),n=0,s=0;n<h.length;){var a=h.b[n],f=h.b[n+1],l=h.b[n+2],u=h.b[n+3];e.data[s]=((a<0?0:a>255?255:a)<<24)+((f<0?0:f>255?255:f)<<16)+((l<0?0:l>255?255:l)<<8)+(u<0?0:u>255?255:u),n+=4,++s}return e},w.createFromByteArray=function(t,i,h){for(var r=new H(new ArrayBuffer(h.length)),o=0;o<h.length;)r.b[o]=h[o],++o;if(null==r)throw W.thrown("FAIL: bytes != null");var e=r.length,n=t*i*4;if(e!=n)throw W.thrown("FAIL: values are not equal (expected: "+n+", actual: "+e+")");for(var s=w.createBitmapOfLength(t,i,r.length/4|0),a=(o=0,0);o<r.length;){var f=r.b[o],l=r.b[o+1],u=r.b[o+2],g=r.b[o+3];s.data[a]=((f<0?0:f>255?255:f)<<24)+((l<0?0:l>255?255:l)<<16)+((u<0?0:u>255?255:u)<<8)+(g<0?0:g>255?255:g),o+=4,++a}return s},w.__super__=u,w.prototype=h(u.prototype,{getPixel:function(t,i){var h=this.offsetY*this.originalWidth+this.offsetX+(this.originalWidth*i+t);return this.data[h]},setPixel:function(t,i,h){var r=this.offsetY*this.originalWidth+this.offsetX+(this.originalWidth*i+t);this.data[r]=h},clone:function(){var t=w.createBitmapOfLength(this.originalWidth,this.originalHeight,this.data.length),i=this.width!=this.originalWidth||this.height!=this.originalHeight||0!=this.offsetX||0!=this.offsetY?{x:this.offsetX,y:this.offsetY,width:this.width,height:this.height}:null;if(null==i)t.width=t.originalWidth,t.height=t.originalHeight,t.offsetX=0,t.offsetY=0;else{if(i.width<=0)throw W.thrown("FAIL: offset.width > 0");if(i.x+i.width>t.originalWidth)throw W.thrown("FAIL: offset.x + offset.width <= originalWidth");if(i.height<=0)throw W.thrown("FAIL: offset.height > 0");if(i.y+i.height>t.originalHeight)throw W.thrown("FAIL: offset.y + offset.height <= originalHeight");if(i.x<0)throw W.thrown("FAIL: offset.x >= 0");if(i.y<0)throw W.thrown("FAIL: offset.y >= 0");t.width=i.width,t.height=i.height,t.offsetX=i.x,t.offsetY=i.y}for(var h=0,r=this.data.length;h<r;){var o=h++;t.data[o]=this.data[o]}return t},fill:function(t){for(var i=0;i<this.data.length;)this.data[i]=t>>24&255,this.data[i+1]=t>>16&255,this.data[i+2]=t>>8&255,this.data[i+3]=255&t,i+=4},getBytes:function(){for(var t=new H(new ArrayBuffer(4*this.data.length)),i=0;i<this.data.length;){var h=4*i;t.b[h]=this.data[i]>>24&255,t.b[h+1]=this.data[i]>>16&255,t.b[h+2]=this.data[i]>>8&255,t.b[h+3]=255&this.data[i],++i}return t}});var g=t.geometrize.exporter.ShapeJsonExporter=function(){};g.export=function(t){return"[\n"+g.exportShapes(t)+"\n]"},g.exportShapes=function(t){for(var i="",h=0,r=t.length;h<r;){var o=h++;i+=g.exportShape(t[o]),o!=t.length-1&&(i+=",\n")}return i},g.exportShape=function(t){var i="    {\n",h=t.shape.getType(),r=t.shape.getRawShapeData(),o=t.color,e=t.score;i+='        "type":'+h+",\n",i+='        "data":[';for(var n=0,s=r.length;n<s;){var a=n++;i+=r[a],a<=r.length-2&&(i+=",")}return i+="],\n",i+='        "color":[',i+=(o>>24&255)+",",i+=(o>>16&255)+",",i+=(o>>8&255)+",",i+=255&o,i+="],\n",i+='        "score":'+e+"\n",i+="    }"};var d=t.geometrize.exporter.SvgExporter=function(){};d.export=function(t,i,h){var r=d.getSvgPrelude();return r+=d.getSvgNodeOpen(i,h),r+=d.exportShapes(t),r+=d.getSvgNodeClose()},d.exportShapes=function(t){for(var i="",h=0,r=t.length;h<r;){var o=h++;i+=d.exportShape(t[o]),o!=t.length-1&&(i+="\n")}return i},d.exportShape=function(t){return e.replace(t.shape.getSvgShapeData(),d.SVG_STYLE_HOOK,d.stylesForShape(t))},d.getSvgPrelude=function(){return'<?xml version="1.0" standalone="no"?>\n'},d.getSvgNodeOpen=function(t,i){return'<svg xmlns="http://www.w3.org/2000/svg" version="1.2" baseProfile="tiny" width="'+t+'" height="'+i+'">\n'},d.getSvgNodeClose=function(){return"</svg>"},d.stylesForShape=function(t){switch(t.shape.getType()){case 6:case 7:return d.strokeForColor(t.color)+' stroke-width="1" fill="none" '+d.strokeOpacityForAlpha(255&t.color);default:return d.fillForColor(t.color)+" "+d.fillOpacityForAlpha(255&t.color)}},d.rgbForColor=function(t){return"rgb("+(t>>24&255)+","+(t>>16&255)+","+(t>>8&255)+")"},d.strokeForColor=function(t){return'stroke="'+d.rgbForColor(t)+'"'},d.fillForColor=function(t){return'fill="'+d.rgbForColor(t)+'"'},d.fillOpacityForAlpha=function(t){return'fill-opacity="'+t/255+'"'},d.strokeOpacityForAlpha=function(t){return'stroke-opacity="'+t/255+'"'};var x=function(){};x.drawLines=function(t,i,h){if(null==t)throw W.thrown("FAIL: image != null");if(null==h)throw W.thrown("FAIL: lines != null");var r=i>>24&255;r|=r<<8,r=(r*=255&i)/255|0;var o=i>>16&255;o|=o<<8,o=(o*=255&i)/255|0;var e=i>>8&255;e|=e<<8,e=(e*=255&i)/255|0;var s=255&i;s|=s<<8;for(var a=0;a<h.length;){var f=h[a];++a;for(var l=f.y,u=65535,w=65535,g=0|257*(w-1*s),d=f.x1,x=f.x2+1;d<x;){var y=d++,c=t.offsetY*t.originalWidth+t.offsetX+(t.originalWidth*l+y),p=t.data[c],m=p>>24&255,v=p>>16&255,F=p>>8&255,L=255&p,A=(n.toFloat(m*g+r*u)/n.toFloat(w)|0)>>8,I=(n.toFloat(v*g+o*u)/n.toFloat(w)|0)>>8,M=(n.toFloat(F*g+e*u)/n.toFloat(w)|0)>>8,S=(n.toFloat(L*g+s*u)/n.toFloat(w)|0)>>8,B=t.offsetY*t.originalWidth+t.offsetX+(t.originalWidth*l+y);t.data[B]=((A<0?0:A>255?255:A)<<24)+((I<0?0:I>255?255:I)<<16)+((M<0?0:M>255?255:M)<<8)+(S<0?0:S>255?255:S)}}},x.copyLines=function(t,i,h){if(null==t)throw W.thrown("FAIL: destination != null");if(null==i)throw W.thrown("FAIL: source != null");if(null==h)throw W.thrown("FAIL: lines != null");for(var r=0;r<h.length;){var o=h[r];++r;for(var e=o.y,n=o.x1,s=o.x2+1;n<s;){var a=n++,f=i.offsetY*i.originalWidth+i.offsetX+(i.originalWidth*e+a),l=t.offsetY*t.originalWidth+t.offsetX+(t.originalWidth*e+a);t.data[l]=i.data[f]}}},x.bresenham=function(t,i,h,r){var o=h-t,e=(o>0?1:0)-(o<0?1:0);o=(o<0?-o:o)<<1;var n=r-i,s=(n>0?1:0)-(n<0?1:0);n=(n<0?-n:n)<<1;var a=[];if(a.push({x:t,y:i}),o>=n)for(var f=n-(o>>1);t!=h;)f>=0&&(0!=f||e>0)&&(f-=o,i+=s),f+=n,t+=e,a.push({x:t,y:i});else for(f=o-(n>>1);i!=r;)f>=0&&(0!=f||s>0)&&(f-=n,t+=e),f+=o,i+=s,a.push({x:t,y:i});return a},x.scanlinesForPolygon=function(t){for(var i=[],h=[],r=0,o=t.length;r<o;){var e=r++,n=t[e],a=e==t.length-1?t[0]:t[e+1],f=x.bresenham(n.x,n.y,a.x,a.y);h=h.concat(f)}var l=new Y;for(r=0;r<h.length;){var u=h[r];++r;var w=l.h[u.y];null!=w?s.add(w,u.x):(w=s.create(),s.add(w,u.x),l.h[u.y]=w)}for(var g=l.keys();g.hasNext();){var d,c=g.next(),p=s.toArray(l.h[c]);if(null==p||0==p.length)d={x:0,y:0};else{var m=p[0],v=p[0];for(r=0;r<p.length;){var F=p[r];++r,m>F&&(m=F),v<F&&(v=F)}d={x:m,y:v}}i.push(new y(c,d.x,d.y))}return i};var y=function(t,i,h){this.y=t,this.x1=i,this.x2=h};y.trim=function(t,i,h){if(null==t)throw W.thrown("FAIL: scanlines != null");for(var r=i,o=h,e=function(t){if(t.y<0||t.y>=o||t.x1>=r||t.x2<0)return!1;var i,h=t.x1;if(0>(i=r-1))throw W.thrown("FAIL: min <= max");if(t.x1=h<0?0:h>i?i:h,h=t.x2,0>(i=r-1))throw W.thrown("FAIL: min <= max");return t.x2=h<0?0:h>i?i:h,t.x1<=t.x2},n=[],s=0,a=t;s<a.length;){var f=a[s];++s,e(f)&&n.push(f)}return n},y.trimHelper=function(t,i,h){if(t.y<0||t.y>=h||t.x1>=i||t.x2<0)return!1;var r,o=t.x1;if(0>(r=i-1))throw W.thrown("FAIL: min <= max");if(t.x1=o<0?0:o>r?r:o,o=t.x2,0>(r=i-1))throw W.thrown("FAIL: min <= max");return t.x2=o<0?0:o>r?r:o,t.x1<=t.x2},(t.geometrize.runner.ImageRunner=function(t,i){this.model=null,this.model=new f(t,i)}).prototype={setOffset:function(t){var i=this.model,h=i.current;if(null==t)h.width=h.originalWidth,h.height=h.originalHeight,h.offsetX=0,h.offsetY=0;else{if(t.width<=0)throw W.thrown("FAIL: offset.width > 0");if(t.x+t.width>h.originalWidth)throw W.thrown("FAIL: offset.x + offset.width <= originalWidth");if(t.height<=0)throw W.thrown("FAIL: offset.height > 0");if(t.y+t.height>h.originalHeight)throw W.thrown("FAIL: offset.y + offset.height <= originalHeight");if(t.x<0)throw W.thrown("FAIL: offset.x >= 0");if(t.y<0)throw W.thrown("FAIL: offset.y >= 0");h.width=t.width,h.height=t.height,h.offsetX=t.x,h.offsetY=t.y}if(h=i.current,null==t)h.width=h.originalWidth,h.height=h.originalHeight,h.offsetX=0,h.offsetY=0;else{if(t.width<=0)throw W.thrown("FAIL: offset.width > 0");if(t.x+t.width>h.originalWidth)throw W.thrown("FAIL: offset.x + offset.width <= originalWidth");if(t.height<=0)throw W.thrown("FAIL: offset.height > 0");if(t.y+t.height>h.originalHeight)throw W.thrown("FAIL: offset.y + offset.height <= originalHeight");if(t.x<0)throw W.thrown("FAIL: offset.x >= 0");if(t.y<0)throw W.thrown("FAIL: offset.y >= 0");h.width=t.width,h.height=t.height,h.offsetX=t.x,h.offsetY=t.y}if(h=i.target,null==t)h.width=h.originalWidth,h.height=h.originalHeight,h.offsetX=0,h.offsetY=0;else{if(t.width<=0)throw W.thrown("FAIL: offset.width > 0");if(t.x+t.width>h.originalWidth)throw W.thrown("FAIL: offset.x + offset.width <= originalWidth");if(t.height<=0)throw W.thrown("FAIL: offset.height > 0");if(t.y+t.height>h.originalHeight)throw W.thrown("FAIL: offset.y + offset.height <= originalHeight");if(t.x<0)throw W.thrown("FAIL: offset.x >= 0");if(t.y<0)throw W.thrown("FAIL: offset.y >= 0");h.width=t.width,h.height=t.height,h.offsetX=t.x,h.offsetY=t.y}i.width=i.target.width,i.height=i.target.height,i.score=a.differenceFull(i.target,i.current)},step:function(t){var i=null!=t.shapeTypes&&0!=t.shapeTypes.length?t.shapeTypes:c.options.shapeTypes,h=null!=t.alpha?t.alpha:c.options.alpha,r=null!=t.candidateShapesPerStep?t.candidateShapesPerStep:c.options.candidateShapesPerStep,o=null!=t.shapeMutationsPerStep?t.shapeMutationsPerStep:c.options.shapeMutationsPerStep;return this.model.step(i,h,r,o)},getImageData:function(){if(null==this.model)throw W.thrown("FAIL: model != null");return this.model.current}};var c=function(){},p=function(t,i){this.x=o.random(t),this.y=o.random(i),this.rx=o.random(32)+1,this.ry=o.random(32)+1,this.xBound=t,this.yBound=i};p.prototype={rasterize:function(){for(var t=[],i=this.rx/this.ry,h=this.xBound,r=this.yBound,o=0,e=this.ry;o<e;){var n=o++,s=this.y-n,a=this.y+n;if(!(s<0||s>=r)||!(a<0||a>=r)){var f=Math.sqrt(this.ry*this.ry-n*n)*i|0,l=this.x-f,u=this.x+f;l<0&&(l=0),u>=h&&(u=h-1),s>=0&&s<r&&t.push(new y(s,l,u)),a>=0&&a<r&&n>0&&t.push(new y(a,l,u))}}return t},mutate:function(){switch(o.random(3)){case 0:var t=this.x+(-16+Math.floor(33*Math.random()));if(0>(i=this.xBound-1))throw W.thrown("FAIL: min <= max");if(this.x=t<0?0:t>i?i:t,t=this.y+(-16+Math.floor(33*Math.random())),0>(i=this.yBound-1))throw W.thrown("FAIL: min <= max");this.y=t<0?0:t>i?i:t;break;case 1:if(t=this.rx+(-16+Math.floor(33*Math.random())),1>(i=this.xBound-1))throw W.thrown("FAIL: min <= max");this.rx=t<1?1:t>i?i:t;break;case 2:var i;if(t=this.ry+(-16+Math.floor(33*Math.random())),1>(i=this.xBound-1))throw W.thrown("FAIL: min <= max");this.ry=t<1?1:t>i?i:t}},clone:function(){var t=new p(this.xBound,this.yBound);return t.x=this.x,t.y=this.y,t.rx=this.rx,t.ry=this.ry,t},getType:function(){return 3},getRawShapeData:function(){return[this.x,this.y,this.rx,this.ry]},getSvgShapeData:function(){return'<ellipse cx="'+this.x+'" cy="'+this.y+'" rx="'+this.rx+'" ry="'+this.ry+'" '+d.SVG_STYLE_HOOK+" />"},translate:function(t){this.x+=t.x,this.rx+=t.x,this.y+=t.y,this.ry+=t.y}};var m=function(t,i){p.call(this,t,i),this.rx=o.random(32)+1,this.ry=this.rx};m.__super__=p,m.prototype=h(p.prototype,{mutate:function(){switch(h=o.random(2)){case 0:var t=this.x+(-16+Math.floor(33*Math.random()));if(0>(i=this.xBound-1))throw W.thrown("FAIL: min <= max");if(this.x=t<0?0:t>i?i:t,t=this.y+(-16+Math.floor(33*Math.random())),0>(i=this.yBound-1))throw W.thrown("FAIL: min <= max");this.y=t<0?0:t>i?i:t;break;case 1:var i;if(t=this.rx+(-16+Math.floor(33*Math.random())),1>(i=this.xBound-1))throw W.thrown("FAIL: min <= max");var h=t<1?1:t>i?i:t;this.rx=h,this.ry=h}},clone:function(){var t=new m(this.xBound,this.yBound);return t.x=this.x,t.y=this.y,t.rx=this.rx,t.ry=this.ry,t},getType:function(){return 5},getRawShapeData:function(){return[this.x,this.y,this.rx]},getSvgShapeData:function(){return'<circle cx="'+this.x+'" cy="'+this.y+'" r="'+this.rx+'" '+d.SVG_STYLE_HOOK+" />"}});var v=function(t,i){this.x1=o.random(t),this.y1=o.random(i);var h=this.x1+o.random(32)+1;if(0>t)throw W.thrown("FAIL: min <= max");if(this.x2=h<0?0:h>t?t:h,h=this.y1+o.random(32)+1,0>i)throw W.thrown("FAIL: min <= max");this.y2=h<0?0:h>i?i:h,this.xBound=t,this.yBound=i};v.prototype={rasterize:function(){for(var t=[],i=x.bresenham(this.x1,this.y1,this.x2,this.y2),h=0;h<i.length;){var r=i[h];++h,t.push(new y(r.y,r.x,r.x))}return y.trim(t,this.xBound,this.yBound)},mutate:function(){switch(o.random(4)){case 0:var t=this.x1+(-16+Math.floor(33*Math.random()));if(0>(i=this.xBound-1))throw W.thrown("FAIL: min <= max");if(this.x1=t<0?0:t>i?i:t,t=this.y1+(-16+Math.floor(33*Math.random())),0>(i=this.yBound-1))throw W.thrown("FAIL: min <= max");this.y1=t<0?0:t>i?i:t;break;case 1:if(t=this.x2+(-16+Math.floor(33*Math.random())),0>(i=this.xBound-1))throw W.thrown("FAIL: min <= max");var i;if(this.x2=t<0?0:t>i?i:t,t=this.y2+(-16+Math.floor(33*Math.random())),0>(i=this.yBound-1))throw W.thrown("FAIL: min <= max");this.y2=t<0?0:t>i?i:t}},clone:function(){var t=new v(this.xBound,this.yBound);return t.x1=this.x1,t.y1=this.y1,t.x2=this.x2,t.y2=this.y2,t},getType:function(){return 6},getRawShapeData:function(){return[this.x1,this.y1,this.x2,this.y2]},getSvgShapeData:function(){return'<line x1="'+this.x1+'" y1="'+this.y1+'" x2="'+this.x2+'" y2="'+this.y2+'" '+d.SVG_STYLE_HOOK+" />"},translate:function(t){this.x1+=t.x,this.x2+=t.x,this.y1+=t.y,this.y2+=t.y}};var F=function(t,i){var h;if(0>(h=t-1))throw W.thrown("FAIL: lower <= upper");if(this.x1=Math.floor((h+1)*Math.random()),0>(h=i-1))throw W.thrown("FAIL: lower <= upper");if(this.y1=Math.floor((h+1)*Math.random()),0>(h=t-1))throw W.thrown("FAIL: lower <= upper");if(this.cx=Math.floor((h+1)*Math.random()),0>(h=i-1))throw W.thrown("FAIL: lower <= upper");if(this.cy=Math.floor((h+1)*Math.random()),0>(h=t-1))throw W.thrown("FAIL: lower <= upper");if(this.x2=Math.floor((h+1)*Math.random()),0>(h=i-1))throw W.thrown("FAIL: lower <= upper");this.y2=Math.floor((h+1)*Math.random()),this.xBound=t,this.yBound=i};F.prototype={rasterize:function(){for(var t=[],i=[],h=0,r=19;h<r;){var o=(a=h++)/20,e=1-o,n=e*(e*this.x1+o*this.cx)+o*(e*this.cx+o*this.x2)|0,s=e*(e*this.y1+o*this.cy)+o*(e*this.cy+o*this.y2)|0;i.push({x:n,y:s})}for(h=0,r=i.length-1;h<r;)for(var a,f=i[a=h++],l=i[a+1],u=x.bresenham(f.x,f.y,l.x,l.y),w=0;w<u.length;){var g=u[w];if(++w,t.length>0){var d=t[t.length-1];if(d.y==g.y&&d.x1==g.x&&d.x2==g.x)continue}t.push(new y(g.y,g.x,g.x))}return y.trim(t,this.xBound,this.yBound)},mutate:function(){switch(Math.floor(3*Math.random())){case 0:var t=this.cx+(-8+Math.floor(17*Math.random()));if(0>(i=this.xBound-1))throw W.thrown("FAIL: min <= max");if(this.cx=t<0?0:t>i?i:t,t=this.cy+(-8+Math.floor(17*Math.random())),0>(i=this.yBound-1))throw W.thrown("FAIL: min <= max");this.cy=t<0?0:t>i?i:t;break;case 1:if(t=this.x1+(-8+Math.floor(17*Math.random())),1>(i=this.xBound-1))throw W.thrown("FAIL: min <= max");if(this.x1=t<1?1:t>i?i:t,t=this.y1+(-8+Math.floor(17*Math.random())),1>(i=this.yBound-1))throw W.thrown("FAIL: min <= max");this.y1=t<1?1:t>i?i:t;break;case 2:if(t=this.x2+(-8+Math.floor(17*Math.random())),1>(i=this.xBound-1))throw W.thrown("FAIL: min <= max");var i;if(this.x2=t<1?1:t>i?i:t,t=this.y2+(-8+Math.floor(17*Math.random())),1>(i=this.yBound-1))throw W.thrown("FAIL: min <= max");this.y2=t<1?1:t>i?i:t}},clone:function(){var t=new F(this.xBound,this.yBound);return t.cx=this.cx,t.cy=this.cy,t.x1=this.x1,t.y1=this.y1,t.x2=this.x2,t.y2=this.y2,t},getType:function(){return 7},getRawShapeData:function(){return[this.x1,this.y1,this.cx,this.cy,this.x2,this.y2]},getSvgShapeData:function(){return'<path d="M'+this.x1+" "+this.y1+" Q "+this.cx+" "+this.cy+" "+this.x2+" "+this.y2+'" '+d.SVG_STYLE_HOOK+" />"},translate:function(t){this.x1+=t.x,this.x2+=t.x,this.cx+=t.x,this.cy+=t.y,this.y1+=t.y,this.y2+=t.y}};var L=function(t,i){this.x1=o.random(t),this.y1=o.random(i);var h,r=this.x1+o.random(32)+1;if(0>(h=t-1))throw W.thrown("FAIL: min <= max");if(this.x2=r<0?0:r>h?h:r,r=this.y1+o.random(32)+1,0>(h=i-1))throw W.thrown("FAIL: min <= max");this.y2=r<0?0:r>h?h:r,this.xBound=t,this.yBound=i};L.prototype={rasterize:function(){var t=[],i=(r=this.y1)<(o=this.y2)?r:o,h=(r=this.y1)>(o=this.y2)?r:o;if(i==h){var r=this.x1,o=this.x2,e=this.x1,n=this.x2;t.push(new y(i,r<o?r:o,e>n?e:n))}else for(var s=i,a=h;s<a;){var f=s++;r=this.x1,o=this.x2,e=this.x1,n=this.x2,t.push(new y(f,r<o?r:o,e>n?e:n))}return t},mutate:function(){switch(o.random(2)){case 0:var t=this.x1+(-16+Math.floor(33*Math.random()));if(0>(i=this.xBound-1))throw W.thrown("FAIL: min <= max");if(this.x1=t<0?0:t>i?i:t,t=this.y1+(-16+Math.floor(33*Math.random())),0>(i=this.yBound-1))throw W.thrown("FAIL: min <= max");this.y1=t<0?0:t>i?i:t;break;case 1:if(t=this.x2+(-16+Math.floor(33*Math.random())),0>(i=this.xBound-1))throw W.thrown("FAIL: min <= max");var i;if(this.x2=t<0?0:t>i?i:t,t=this.y2+(-16+Math.floor(33*Math.random())),0>(i=this.yBound-1))throw W.thrown("FAIL: min <= max");this.y2=t<0?0:t>i?i:t}},clone:function(){var t=new L(this.xBound,this.yBound);return t.x1=this.x1,t.y1=this.y1,t.x2=this.x2,t.y2=this.y2,t},getType:function(){return 0},getRawShapeData:function(){var t=this.x1,i=this.x2,h=this.y1,r=this.y2,o=this.x1,e=this.x2,n=this.y1,s=this.y2;return[t<i?t:i,h<r?h:r,o>e?o:e,n>s?n:s]},getSvgShapeData:function(){var t=this.x1,i=this.x2,h=this.y1,r=this.y2,o=this.x1,e=this.x2,n=this.x1,s=this.x2,a=this.y1,f=this.y2,l=this.y1,u=this.y2;return'<rect x="'+(t<i?t:i)+'" y="'+(h<r?h:r)+'" width="'+((o>e?o:e)-(n<s?n:s))+'" height="'+((a>f?a:f)-(l<u?l:u))+'" '+d.SVG_STYLE_HOOK+" />"},translate:function(t){this.x1+=t.x,this.x2+=t.x,this.y1+=t.y,this.y2+=t.y}};var A=function(t,i){this.x=o.random(t),this.y=o.random(i),this.rx=o.random(32)+1,this.ry=o.random(32)+1,this.angle=o.random(360),this.xBound=t,this.yBound=i};A.prototype={rasterize:function(){for(var t=[],i=this.angle*(Math.PI/180),h=Math.cos(i),r=Math.sin(i),o=0;o<20;){var e=18*o++*(Math.PI/180),n=this.rx*Math.cos(e),s=this.ry*Math.sin(e),a=n*h-s*r+this.x|0,f=n*r+s*h+this.y|0;t.push({x:a,y:f})}return y.trim(x.scanlinesForPolygon(t),this.xBound,this.yBound)},mutate:function(){switch(o.random(4)){case 0:var t=this.x+(-16+Math.floor(33*Math.random()));if(0>(i=this.xBound-1))throw W.thrown("FAIL: min <= max");if(this.x=t<0?0:t>i?i:t,t=this.y+(-16+Math.floor(33*Math.random())),0>(i=this.yBound-1))throw W.thrown("FAIL: min <= max");this.y=t<0?0:t>i?i:t;break;case 1:if(t=this.rx+(-16+Math.floor(33*Math.random())),1>(i=this.xBound-1))throw W.thrown("FAIL: min <= max");this.rx=t<1?1:t>i?i:t;break;case 2:var i;if(t=this.ry+(-16+Math.floor(33*Math.random())),1>(i=this.yBound-1))throw W.thrown("FAIL: min <= max");this.ry=t<1?1:t>i?i:t;break;case 3:t=this.angle+(-4+Math.floor(9*Math.random())),this.angle=t<0?0:t>360?360:t}},clone:function(){var t=new A(this.xBound,this.yBound);return t.x=this.x,t.y=this.y,t.rx=this.rx,t.ry=this.ry,t.angle=this.angle,t},getType:function(){return 4},getRawShapeData:function(){return[this.x,this.y,this.rx,this.ry,this.angle]},getSvgShapeData:function(){var t='<g transform="translate('+this.x+" "+this.y+") rotate("+this.angle+") scale("+this.rx+" "+this.ry+')">';return t+='<ellipse cx="0" cy="0" rx="1" ry="1" '+d.SVG_STYLE_HOOK+" />",t+="</g>"},translate:function(t){this.x+=t.x,this.rx+=t.x,this.y+=t.y,this.ry+=t.y}};var I=function(t,i){this.x1=o.random(t),this.y1=o.random(i);var h=this.x1+o.random(32)+1;if(0>t)throw W.thrown("FAIL: min <= max");if(this.x2=h<0?0:h>t?t:h,h=this.y1+o.random(32)+1,0>i)throw W.thrown("FAIL: min <= max");this.y2=h<0?0:h>i?i:h,this.angle=Math.floor(361*Math.random()),this.xBound=t,this.yBound=i};I.prototype={rasterize:function(){var t,i,h=(t=this.x1)<(i=this.x2)?t:i,r=(t=this.x1)>(i=this.x2)?t:i,o=(t=this.y1)<(i=this.y2)?t:i,e=(t=this.y1)>(i=this.y2)?t:i,n=(h+r)/2|0,s=(o+e)/2|0,a=h-n,f=r-n,l=o-s,u=e-s,w=this.angle*Math.PI/180,g=Math.cos(w),d=Math.sin(w),c=a*g-l*d+n|0,p=a*d+l*g+s|0,m=a*g-u*d+n|0,v=a*d+u*g+s|0,F=f*g-l*d+n|0,L=f*d+l*g+s|0,A=f*g-u*d+n|0,I=f*d+u*g+s|0;return y.trim(x.scanlinesForPolygon([{x:c,y:p},{x:F,y:L},{x:A,y:I},{x:m,y:v}]),this.xBound,this.yBound)},mutate:function(){switch(o.random(3)){case 0:var t=this.x1+(-16+Math.floor(33*Math.random()));if(0>(i=this.xBound-1))throw W.thrown("FAIL: min <= max");if(this.x1=t<0?0:t>i?i:t,t=this.y1+(-16+Math.floor(33*Math.random())),0>(i=this.yBound-1))throw W.thrown("FAIL: min <= max");this.y1=t<0?0:t>i?i:t;break;case 1:if(t=this.x2+(-16+Math.floor(33*Math.random())),0>(i=this.xBound-1))throw W.thrown("FAIL: min <= max");var i;if(this.x2=t<0?0:t>i?i:t,t=this.y2+(-16+Math.floor(33*Math.random())),0>(i=this.yBound-1))throw W.thrown("FAIL: min <= max");this.y2=t<0?0:t>i?i:t;break;case 2:t=this.angle+(-4+Math.floor(9*Math.random())),this.angle=t<0?0:t>360?360:t}},clone:function(){var t=new I(this.xBound,this.yBound);return t.x1=this.x1,t.y1=this.y1,t.x2=this.x2,t.y2=this.y2,t.angle=this.angle,t},getType:function(){return 1},getRawShapeData:function(){var t=this.x1,i=this.x2,h=this.y1,r=this.y2,o=this.x1,e=this.x2,n=this.y1,s=this.y2;return[t<i?t:i,h<r?h:r,o>e?o:e,n>s?n:s,this.angle]},getSvgShapeData:function(){for(var t,i,h=(t=this.x1)<(i=this.x2)?t:i,r=(t=this.x1)>(i=this.x2)?t:i,o=(t=this.y1)<(i=this.y2)?t:i,e=(t=this.y1)>(i=this.y2)?t:i,n=(h+r)/2|0,s=(o+e)/2|0,a=h-n,f=r-n,l=o-s,u=e-s,w=this.angle*Math.PI/180,g=Math.cos(w),x=[{x:a*g-l*(y=Math.sin(w))+n|0,y:a*y+l*g+s|0},{x:f*g-l*y+n|0,y:f*y+l*g+s|0},{x:f*g-u*y+n|0,y:f*y+u*g+s|0},{x:a*g-u*y+n|0,y:a*y+u*g+s|0}],y='<polygon points="',c=0,p=x.length;c<p;){var m=c++;y+=x[m].x+" "+x[m].y,m!=x.length-1&&(y+=" ")}return y+='" '+d.SVG_STYLE_HOOK+"/>"},getCornerPoints:function(){var t,i,h=(t=this.x1)<(i=this.x2)?t:i,r=(t=this.x1)>(i=this.x2)?t:i,o=(t=this.y1)<(i=this.y2)?t:i,e=(t=this.y1)>(i=this.y2)?t:i,n=(h+r)/2|0,s=(o+e)/2|0,a=h-n,f=r-n,l=o-s,u=e-s,w=this.angle*Math.PI/180,g=Math.cos(w),d=Math.sin(w);return[{x:a*g-l*d+n|0,y:a*d+l*g+s|0},{x:f*g-l*d+n|0,y:f*d+l*g+s|0},{x:f*g-u*d+n|0,y:f*d+u*g+s|0},{x:a*g-u*d+n|0,y:a*d+u*g+s|0}]},translate:function(t){this.x1+=t.x,this.x2+=t.x,this.y1+=t.y,this.y2+=t.y}};var M=function(){};M.create=function(t,i,h){switch(t){case 0:return new L(i,h);case 1:return new I(i,h);case 2:return new B(i,h);case 3:return new p(i,h);case 4:return new A(i,h);case 5:return new m(i,h);case 6:return new v(i,h);case 7:return new F(i,h)}},M.randomShape=function(t,i){var h=[0,1,2,3,4,5,6,7];if(!(null!=h&&h.length>0))throw W.thrown("FAIL: a != null && a.length > 0");var r=h.length-1;if(0>r)throw W.thrown("FAIL: lower <= upper");return M.create(h[Math.floor((r+1)*Math.random())],t,i)},M.randomShapeOf=function(t,i,h){if(!(null!=t&&t.length>0))throw W.thrown("FAIL: a != null && a.length > 0");var r=t.length-1;if(0>r)throw W.thrown("FAIL: lower <= upper");return M.create(t[Math.floor((r+1)*Math.random())],i,h)};var S=t.geometrize.shape.ShapeTypes=function(){},B=function(t,i){this.x1=o.random(t),this.y1=o.random(i),this.x2=this.x1+(-16+Math.floor(33*Math.random())),this.y2=this.y1+(-16+Math.floor(33*Math.random())),this.x3=this.x1+(-16+Math.floor(33*Math.random())),this.y3=this.y1+(-16+Math.floor(33*Math.random())),this.xBound=t,this.yBound=i};B.prototype={rasterize:function(){return y.trim(x.scanlinesForPolygon([{x:this.x1,y:this.y1},{x:this.x2,y:this.y2},{x:this.x3,y:this.y3}]),this.xBound,this.yBound)},mutate:function(){switch(o.random(3)){case 0:var t=this.x1+(-16+Math.floor(33*Math.random()));if(0>(i=this.xBound-1))throw W.thrown("FAIL: min <= max");if(this.x1=t<0?0:t>i?i:t,t=this.y1+(-16+Math.floor(33*Math.random())),0>(i=this.yBound-1))throw W.thrown("FAIL: min <= max");this.y1=t<0?0:t>i?i:t;break;case 1:if(t=this.x2+(-16+Math.floor(33*Math.random())),0>(i=this.xBound-1))throw W.thrown("FAIL: min <= max");if(this.x2=t<0?0:t>i?i:t,t=this.y2+(-16+Math.floor(33*Math.random())),0>(i=this.yBound-1))throw W.thrown("FAIL: min <= max");this.y2=t<0?0:t>i?i:t;break;case 2:if(t=this.x3+(-16+Math.floor(33*Math.random())),0>(i=this.xBound-1))throw W.thrown("FAIL: min <= max");var i;if(this.x3=t<0?0:t>i?i:t,t=this.y3+(-16+Math.floor(33*Math.random())),0>(i=this.yBound-1))throw W.thrown("FAIL: min <= max");this.y3=t<0?0:t>i?i:t}},clone:function(){var t=new B(this.xBound,this.yBound);return t.x1=this.x1,t.y1=this.y1,t.x2=this.x2,t.y2=this.y2,t.x3=this.x3,t.y3=this.y3,t},getType:function(){return 2},getRawShapeData:function(){return[this.x1,this.y1,this.x2,this.y2,this.x3,this.y3]},getSvgShapeData:function(){return'<polygon points="'+this.x1+","+this.y1+" "+this.x2+","+this.y2+" "+this.x3+","+this.y3+'" '+d.SVG_STYLE_HOOK+"/>"},translate:function(t){this.x1+=t.x,this.x2+=t.x,this.x3+=t.x,this.y1+=t.y,this.y2+=t.y,this.y3+=t.y}};var W=function(t,i,h){Error.call(this,t),this.message=t,this.__previousException=i,this.__nativeException=null!=h?h:this};W.thrown=function(t){return t instanceof W?t.get_native():t instanceof Error?t:new b(t)},W.__super__=Error,W.prototype=h(Error.prototype,{get_native:function(){return this.__nativeException}});var b=function(t,i,h){W.call(this,String(t),i,h),this.value=t};b.__super__=W,b.prototype=h(W.prototype,{});var Y=function(){this.h={}};Y.prototype={keys:function(){var t=[];for(var i in this.h)this.h.hasOwnProperty(i)&&t.push(0|i);return new O(t)}};var H=function(t){this.length=t.byteLength,this.b=new Uint8Array(t),this.b.bufferValue=t,t.hxBytes=this,t.bytes=this.b},O=function(t){this.current=0,this.array=t};O.prototype={hasNext:function(){return this.current<this.array.length},next:function(){return this.array[this.current++]}},"undefined"!=typeof performance&&"function"==typeof performance.now&&(r.now=performance.now.bind(performance)),d.SVG_STYLE_HOOK="::svg_style_hook::",c.options={shapeTypes:[2],candidateShapesPerStep:50,shapeMutationsPerStep:100,alpha:128},S.RECTANGLE=0,S.ROTATED_RECTANGLE=1,S.TRIANGLE=2,S.ELLIPSE=3,S.ROTATED_ELLIPSE=4,S.CIRCLE=5,S.LINE=6,S.QUADRATIC_BEZIER=7}(i),Object.defineProperty(t,"__esModule",{value:!0});var h=t.ShapeJsonExporter=t.SvgExporter=t.ShapeTypes=t.Bitmap=t.ImageRunner=void 0,r=i.geometrize,o=t.ImageRunner=r.runner.ImageRunner,e=t.Bitmap=r.bitmap.Bitmap,n=t.ShapeTypes=r.shape.ShapeTypes,s=t.SvgExporter=r.exporter.SvgExporter;h=t.ShapeJsonExporter=r.exporter.ShapeJsonExporter;var a=t.__esModule;
export {e as Bitmap,o as ImageRunner,h as ShapeJsonExporter,n as ShapeTypes,s as SvgExporter,a as __esModule,t as default};
//# sourceMappingURL=/sm/6e48fe5f014784c73b704dd3c5ba072afb7186ed87f6b2219e22ff88d0ffd510.map